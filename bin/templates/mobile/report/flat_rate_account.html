<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
	layout:decorator="layout/default" lang="ko">
<div  layout:fragment="content">
	<div class="container-fluid" style="padding-top: 25%;">
		<div class="row">
			<div class="col-xs-12 col-sm-12">
				<form class="form-horizontal">
					<div class="form-group">
						<label for="infoDays" class="col-xs-2 col-sm-4 control-label padTop4 text-muted" style="padding-right: 0px">기간</label>
						<div class="col-xs-10 col-sm-8">
							 <div class='input-group date  input-daterange' >
					            <div class='input-group date' >
					                <input type='text' class="form-control"   id="start_day"/>
					            </div>
						            <span class="input-group-addon">-</span>
					             <div class='input-group date' >
					                <input type='text' class="form-control"  id="end_day" />
					            </div>
				            </div>
			            </div>
					</div>
					<div class="form-group">
						<label for="account" class="col-xs-3 col-sm-2 control-label padTop4 text-muted"  >거래처</label>
						<div class="col-xs-9 col-sm-10">
							<input type="text"  class="form-control" id="account" />
						</div>
					</div>
				</form>
				<div class="row text-center" style="padding-bottom: 10px;">
					<button type="button" class="btn btn-info"  id="bill_search">확인</button>
					<button type="button" class="btn btn-info"  data-toggle="modal" data-target="#accountOutput" id="output_img">출력</button>
				</div>
				<div id="accountCanvas" >
					<div th:replace="/mobile/report/account_form:: accountForm" ></div>
				</div>
				<div class="modal fade"  id="accountOutput">
				  <div class="modal-dialog">
				    <div class="modal-content">
				      <div class="modal-header">
				        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				        <h4 class="modal-title" >청구서(정액)</h4>
				      </div>
				      <div class="modal-body">
				        <img id="supply_Img"  style="width: 100%"/>
				      </div>
				      <div class="modal-footer">
				        <button type="button" class="btn btn-info" data-dismiss="modal">닫기</button>
				      </div>
				    </div><!-- /.modal-content -->
				  </div><!-- /.modal-dialog -->
				</div><!-- /.modal -->
			</div>
		</div>
	</div>
<style>
#accountCanvas {
	padding: 10px; 
	border: 1px solid #d3d3d3; 
	width: max-content; 
	font-size: 13pt; 
	margin-bottom: 20px;
}
</style>
<script th:inline="javascript">
/*<![CDATA[*/
var account = {
		
}

$(document).ready(function() {
	accountInit();
});

function accountInit() {
	setTitle("청구서(정액)");
	accountControles();
	accountFormInit();
	$("#accountCanvas").hide();
	accountEventBind();
}

function accountControles() {
	var today = new Date();
	var todayStr = today.getFullYear() + "-" + setTwinNum(today.getMonth() + 1) + "-" + setTwinNum(today.getDate());
	$('#start_day').datetimepicker({
		useCurrent: false,  
		format: "YYYY-MM-DD"
	 });
	
    $('#end_day').datetimepicker({
    	format: "YYYY-MM-DD"
    });
    
    $('#start_day').val(todayStr);
    $('#end_day').val(todayStr);
    
    $("#start_day").on("dp.change", function (e) {
        $('#end_day').data("DateTimePicker").minDate(e.date);
    });
    $("#end_day").on("dp.change", function (e) {
        $('#start_day').data("DateTimePicker").maxDate(e.date);
    });

}

function accountEventBind() {
	$("#bill_search").click(function() {
		$("#accountCanvas").show();
	});
	
	$("#output_img").click(function() {
		if($("#accountCanvas").css("display") == "none") {
			BootstrapDialog.alert( '검색 후 출력 가능합니다.');
			return false;
		}
		
		html2canvas(document.querySelector("#accountCanvas")).then(canvas => {
			var image = document.getElementById("supply_Img");
			image.src = canvas.toDataURL("image/png");
		});
	});
}
/*]]>*/
</script>
</div>
</html>